{"version":3,"file":"oracle.js","sourceRoot":"","sources":["../../../src/accounts/oracle.ts"],"names":[],"mappings":"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","sourcesContent":["import { SOL_NATIVE_MINT, SPL_TOKEN_PROGRAM_ID } from \"../constants.js\";\n\nimport * as spl from \"./../utils/index.js\";\nimport { ON_DEMAND_MAINNET_QUEUE_PDA } from \"./../utils/index.js\";\nimport { State } from \"./state.js\";\n\nimport type { Program } from \"@coral-xyz/anchor\";\nimport { BN, web3 } from \"@coral-xyz/anchor\";\nimport { Buffer } from \"buffer\";\n\nexport interface OracleAccountData {\n  enclave: {\n    enclaveSigner: web3.PublicKey;\n    mrEnclave: Uint8Array;\n    verificationStatus: number;\n    verificationTimestamp: BN;\n    validUntil: BN;\n    quoteRegistry: Uint8Array;\n    registryKey: Uint8Array;\n  };\n  authority: web3.PublicKey;\n  queue: web3.PublicKey;\n  createdAt: BN;\n  lastHeartbeat: BN;\n  secpAuthority: Uint8Array;\n  gatewayUri: Uint8Array;\n  permissions: BN;\n  isOnQueue: boolean;\n  lutSlot: BN;\n  lastRewardEpoch: BN;\n}\n\n/**\n *  This class represents an oracle account on chain.\n */\nexport class Oracle {\n  lut: web3.AddressLookupTableAccount | null;\n\n  constructor(readonly program: Program, readonly pubkey: web3.PublicKey) {\n    this.lut = null;\n  }\n\n  /**\n   * Creates a new oracle account. linked to the specified queue.\n   * After creation the oracle still must receive run approval and verify their\n   * enclave measurement.\n   * @param program - The program that owns the oracle account.\n   * @param params.queue - The queue that the oracle will be linked to.\n   * @returns A promise that resolves to a tuple containing the oracle account\n   * and the transaction signature.\n   *\n   */\n  static async create(\n    program: Program,\n    params: {\n      queue: web3.PublicKey;\n    }\n  ): Promise<[Oracle, web3.TransactionInstruction[], web3.Keypair]> {\n    const stateKey = State.keyFromSeed(program);\n    const state = await State.loadData(program);\n    const payer = (program.provider as any).wallet.payer;\n    const oracle = web3.Keypair.generate();\n    const oracleStats = (\n      await web3.PublicKey.findProgramAddressSync(\n        [Buffer.from(\"OracleStats\"), oracle.publicKey.toBuffer()],\n        program.programId\n      )\n    )[0];\n    const lutSigner = (\n      await web3.PublicKey.findProgramAddressSync(\n        [Buffer.from(\"LutSigner\"), oracle.publicKey.toBuffer()],\n        program.programId\n      )\n    )[0];\n    const [delegationPool] = await web3.PublicKey.findProgramAddressSync(\n      [\n        Buffer.from(\"Delegation\"),\n        stateKey.toBuffer(),\n        oracleStats.toBuffer(),\n        state.stakePool.toBuffer(),\n      ],\n      state.stakeProgram\n    );\n    const recentSlot = await program.provider.connection.getSlot(\"finalized\");\n    const [_, lut] = web3.AddressLookupTableProgram.createLookupTable({\n      authority: lutSigner,\n      payer: payer.publicKey,\n      recentSlot,\n    });\n    const [delegationGroup] = await web3.PublicKey.findProgramAddressSync(\n      [\n        Buffer.from(\"Group\"),\n        stateKey.toBuffer(),\n        state.stakePool.toBuffer(),\n        params.queue.toBuffer(),\n      ],\n      state.stakeProgram\n    );\n\n    const ix = await program.instruction.oracleInit(\n      {\n        recentSlot: new BN(recentSlot.toString()),\n        authority: payer.publicKey,\n        queue: params.queue,\n        secpAuthority: null,\n      },\n      {\n        accounts: {\n          oracle: oracle.publicKey,\n          oracleStats,\n          authority: payer.publicKey,\n          programState: stateKey,\n          payer: payer.publicKey,\n          systemProgram: web3.SystemProgram.programId,\n          tokenProgram: SPL_TOKEN_PROGRAM_ID,\n          tokenMint: SOL_NATIVE_MINT,\n          delegationPool,\n          lutSigner,\n          lut,\n          addressLookupTableProgram: web3.AddressLookupTableProgram.programId,\n          switchMint: state.switchMint,\n          wsolVault: spl.getAssociatedTokenAddressSync(\n            SOL_NATIVE_MINT,\n            oracle.publicKey\n          ),\n          switchVault: spl.getAssociatedTokenAddressSync(\n            state.switchMint,\n            oracle.publicKey\n          ),\n          stakeProgram: state.stakeProgram,\n          stakePool: state.stakePool,\n        },\n      }\n    );\n    const ix2 = await program.instruction.oracleUpdateDelegation(\n      {\n        recentSlot: new BN(recentSlot.toString()),\n      },\n      {\n        accounts: {\n          oracle: oracle.publicKey,\n          oracleStats,\n          queue: params.queue,\n          authority: payer.publicKey,\n          programState: stateKey,\n          payer: payer.publicKey,\n          systemProgram: web3.SystemProgram.programId,\n          tokenProgram: SPL_TOKEN_PROGRAM_ID,\n          delegationPool,\n          lutSigner,\n          lut,\n          addressLookupTableProgram: web3.AddressLookupTableProgram.programId,\n          switchMint: state.switchMint,\n          nativeMint: SOL_NATIVE_MINT,\n          wsolVault: web3.PublicKey.findProgramAddressSync(\n            [\n              Buffer.from(\"RewardPool\"),\n              delegationPool.toBuffer(),\n              SOL_NATIVE_MINT.toBuffer(),\n            ],\n            state.stakeProgram\n          )[0],\n          switchVault: web3.PublicKey.findProgramAddressSync(\n            [\n              Buffer.from(\"RewardPool\"),\n              delegationPool.toBuffer(),\n              state.switchMint.toBuffer(),\n            ],\n            state.stakeProgram\n          )[0],\n          stakeProgram: state.stakeProgram,\n          stakePool: state.stakePool,\n          delegationGroup,\n        },\n      }\n    );\n    return [new Oracle(program, oracle.publicKey), [ix, ix2], oracle];\n  }\n\n  /**\n   * Creates a new oracle account for SVM chains (non-solana). linked to the specified queue.\n   * After creation the oracle still must receive run approval and verify their\n   * enclave measurement.\n   * @param program - The program that owns the oracle account.\n   * @param params.queue - The queue that the oracle will be linked to.\n   * @returns A promise that resolves to a tuple containing the oracle account\n   * and the transaction signature.\n   *\n   */\n  static async createSVM(\n    program: Program,\n    params: {\n      queue: web3.PublicKey;\n      sourceOracleKey: web3.PublicKey;\n    }\n  ): Promise<[Oracle, web3.TransactionInstruction[]]> {\n    const stateKey = State.keyFromSeed(program);\n    const state = await State.loadData(program);\n    const payer = (program.provider as any).wallet.payer;\n    // Generate the queue PDA for the given source queue key\n    const [oracle] = await web3.PublicKey.findProgramAddress(\n      [\n        Buffer.from(\"Oracle\"),\n        params.queue.toBuffer(),\n        params.sourceOracleKey.toBuffer(),\n      ],\n      program.programId\n    );\n    const oracleStats = (\n      await web3.PublicKey.findProgramAddress(\n        [Buffer.from(\"OracleStats\"), oracle.toBuffer()],\n        program.programId\n      )\n    )[0];\n    const lutSigner = (\n      await web3.PublicKey.findProgramAddress(\n        [Buffer.from(\"LutSigner\"), oracle.toBuffer()],\n        program.programId\n      )\n    )[0];\n    const [delegationPool] = await web3.PublicKey.findProgramAddress(\n      [\n        Buffer.from(\"Delegation\"),\n        stateKey.toBuffer(),\n        oracleStats.toBuffer(),\n        state.stakePool.toBuffer(),\n      ],\n      state.stakeProgram\n    );\n    const recentSlot = await program.provider.connection.getSlot(\"finalized\");\n    const [_, lut] = web3.AddressLookupTableProgram.createLookupTable({\n      authority: lutSigner,\n      payer: payer.publicKey,\n      recentSlot,\n    });\n    const [delegationGroup] = await web3.PublicKey.findProgramAddress(\n      [\n        Buffer.from(\"Group\"),\n        stateKey.toBuffer(),\n        state.stakePool.toBuffer(),\n        params.queue.toBuffer(),\n      ],\n      state.stakeProgram\n    );\n\n    const ix = program.instruction.oracleInitSvm(\n      {\n        recentSlot: new BN(recentSlot.toString()),\n        authority: payer.publicKey,\n        queue: params.queue,\n        secpAuthority: null,\n        sourceOracleKey: params.sourceOracleKey,\n      },\n      {\n        accounts: {\n          oracle: oracle,\n          oracleStats,\n          authority: payer.publicKey,\n          programState: stateKey,\n          payer: payer.publicKey,\n          systemProgram: web3.SystemProgram.programId,\n          tokenProgram: SPL_TOKEN_PROGRAM_ID,\n          tokenMint: SOL_NATIVE_MINT,\n          delegationPool,\n          lutSigner,\n          lut,\n          addressLookupTableProgram: web3.AddressLookupTableProgram.programId,\n          switchMint: state.switchMint,\n          wsolVault: spl.getAssociatedTokenAddressSync(\n            SOL_NATIVE_MINT,\n            oracle,\n            true\n          ),\n          switchVault: spl.getAssociatedTokenAddressSync(\n            state.switchMint,\n            oracle,\n            true\n          ),\n          stakeProgram: state.stakeProgram,\n          stakePool: state.stakePool,\n        },\n      }\n    );\n\n    return [new Oracle(program, oracle), [ix]];\n  }\n\n  /**\n   * ATODO: wrap this one up with the gateway bridge oracle fn\n   * @param params\n   * @returns\n   */\n  static async quoteVerifySvmIx(\n    program: Program,\n    params: {\n      chain?: string; // Unused atm\n      network?: \"mainnet\" | \"mainnet-beta\" | \"testnet\" | \"devnet\";\n      queue: web3.PublicKey; // Solana queue\n      attestee: web3.PublicKey; // Solana attestee\n      attester: web3.PublicKey; // Solana attester guardian we're requesting from\n    }\n  ): Promise<web3.TransactionInstruction> {\n    // const [queuePDA, queueBump] = await PublicKey.findProgramAddress(\n    //   [Buffer.from(\"Queue\"), params.queue.toBuffer()],\n    //   program.programId\n    // );\n\n    // timestamp handled by bridge fn\n    // mrEnclave handled by bridge fn\n    // secp256k1Key handled by bridge fn\n    // slot has to be handled by us I think\n    // signature has to be handled by bridge fn\n    // recoveryId has to be handled by bridge fn\n\n    // guardian key & oracle key\n\n    // source oracle key handled by us:\n\n    // source oracle queue key handled by us:\n\n    // source guardian queue key handled by us:\n\n    // const ix = await program.instruction.guardianQuoteVerifySvm(\n    //   {\n    //     timestamp: new anchor.BN(params.timestamp),\n    //     mrEnclave: params.mrEnclave, // 32-byte array\n    //     _reserved1: params._reserved1, // 32-bit unsigned integer\n    //     secp256k1Key: params.secp256k1Key, // 64-byte array\n    //     slot: new anchor.BN(params.slot), // Slot as u64\n    //     signature: params.signature, // 64-byte array\n    //     recoveryId: params.recoveryId, // u8\n    //     sourceOracleKey: params.sourceOracleKey, // Pubkey of source oracle\n    //     sourceOracleQueueKey: params.sourceOracleQueueKey, // Pubkey of oracle queue\n    //     sourceGuardianQueueKey: params.sourceGuardianQueueKey, // Pubkey of guardian queue\n    //     oracleBump: params.oracleBump, // Bump for oracle PDA\n    //     oracleQueueBump: params.oracleQueueBump, // Bump for oracle queue PDA\n    //     guardianQueueBump: params.guardianQueueBump, // Bump for guardian queue PDA\n    //   },\n    //   {\n    //     accounts: {\n    //       guardian: guardianAccountLoader, // AccountLoader for OracleAccountData\n    //       oracle: oracleAccountLoader, // AccountLoader for OracleAccountData\n    //       oracleStats: oracleStatsAccountLoader, // AccountLoader for OracleStatsAccountData\n    //       payer: payer.publicKey, // Signer for transaction\n    //       systemProgram: SystemProgram.programId, // System program ID\n    //       oracleQueue: oracleQueueAccountLoader, // AccountLoader for QueueAccountData\n    //       guardianQueue: guardianQueueAccountLoader, // AccountLoader for QueueAccountData\n    //       state: stateAccountLoader, // AccountLoader for State\n    //       recentSlothashes: anchor.web3.SYSVAR_SLOT_HASHES_PUBKEY, // Sysvar slot hashes\n    //       lutSigner: lutSignerAccount, // AccountInfo for lut signer\n    //       lut: lutAccount, // AccountInfo for lut (lookup table)\n    //       programState: programStateAccountLoader, // AccountLoader for State\n    //     },\n    //     signers: [payer], // Add payer as the signer for the instruction\n    //   }\n    // );\n\n    throw new Error(\"Quote verify SVM not implemented yet.\");\n  }\n\n  async findSolanaOracleFromPDA(): Promise<{\n    oracleData: any;\n    oracle: web3.PublicKey;\n  }> {\n    const oracleData = await this.loadData();\n    const isMainnet = oracleData.queue.equals(ON_DEMAND_MAINNET_QUEUE_PDA);\n    const queue = await spl.getQueue({\n      program: this.program,\n      queueAddress: spl.getDefaultQueueAddress(isMainnet),\n    });\n    const solanaOracles = await queue.fetchOracleKeys();\n    for (const oracle of solanaOracles) {\n      const [oraclePDA] = await web3.PublicKey.findProgramAddress(\n        [Buffer.from(\"Oracle\"), oracleData.queue.toBuffer(), oracle.toBuffer()],\n        this.program.programId\n      );\n      if (oraclePDA.equals(this.pubkey)) {\n        return {\n          oracleData: await new Oracle(queue.program, oracle).loadData(),\n          oracle,\n        };\n      }\n    }\n    throw new Error(`Solana Oracle not found for ${this.pubkey.toBase58()}`);\n  }\n\n  async updateDelegationRewardPoolsIx(params: {\n    overrideStakePool?: web3.PublicKey;\n    overrideMint?: web3.PublicKey;\n    authority: web3.PublicKey;\n  }): Promise<web3.TransactionInstruction> {\n    const program = this.program;\n    const stateKey = State.keyFromSeed(program);\n    const state = await State.loadData(program);\n    const switchMint = params.overrideMint ?? state.switchMint;\n    const stakePool = params.overrideStakePool ?? state.stakePool;\n    const stakeProgram = state.stakeProgram;\n    const payer = (program.provider as any).wallet.payer;\n    const oracleData = await this.loadData();\n    const oracleStats = (\n      await web3.PublicKey.findProgramAddress(\n        [Buffer.from(\"OracleStats\"), this.pubkey.toBuffer()],\n        program.programId\n      )\n    )[0];\n    const lutSigner = (\n      await web3.PublicKey.findProgramAddress(\n        [Buffer.from(\"LutSigner\"), this.pubkey.toBuffer()],\n        program.programId\n      )\n    )[0];\n    const [delegationPool] = await web3.PublicKey.findProgramAddress(\n      [\n        Buffer.from(\"Delegation\"),\n        stateKey.toBuffer(),\n        oracleStats.toBuffer(),\n        stakePool.toBuffer(),\n      ],\n      stakeProgram\n    );\n    console.log(\"stakepool\", stakePool.toBase58());\n    console.log(\"delegationPool\", delegationPool.toBase58());\n    const lutSlot = oracleData.lutSlot.toNumber();\n    const [_, lut] = web3.AddressLookupTableProgram.createLookupTable({\n      authority: lutSigner,\n      payer: payer.publicKey,\n      recentSlot: lutSlot,\n    });\n    const [delegationGroup] = await web3.PublicKey.findProgramAddress(\n      [\n        Buffer.from(\"Group\"),\n        stateKey.toBuffer(),\n        state.stakePool.toBuffer(),\n        oracleData.queue.toBuffer(),\n      ],\n      stakeProgram\n    );\n    const ix = await program.instruction.oracleUpdateDelegation(\n      {\n        recentSlot: new BN(lutSlot.toString()),\n      },\n      {\n        accounts: {\n          oracle: this.pubkey,\n          oracleStats,\n          queue: oracleData.queue,\n          authority: params.authority,\n          programState: stateKey,\n          payer: payer.publicKey,\n          systemProgram: web3.SystemProgram.programId,\n          tokenProgram: SPL_TOKEN_PROGRAM_ID,\n          delegationPool,\n          lutSigner,\n          lut,\n          addressLookupTableProgram: web3.AddressLookupTableProgram.programId,\n          switchMint: switchMint,\n          nativeMint: SOL_NATIVE_MINT,\n          wsolVault: web3.PublicKey.findProgramAddressSync(\n            [\n              Buffer.from(\"RewardPool\"),\n              delegationPool.toBuffer(),\n              SOL_NATIVE_MINT.toBuffer(),\n            ],\n            stakeProgram\n          )[0],\n          switchVault: web3.PublicKey.findProgramAddressSync(\n            [\n              Buffer.from(\"RewardPool\"),\n              delegationPool.toBuffer(),\n              switchMint.toBuffer(),\n            ],\n            stakeProgram\n          )[0],\n          stakeProgram: stakeProgram,\n          stakePool: stakePool,\n          delegationGroup,\n        },\n      }\n    );\n    return ix;\n  }\n\n  async setConfigsIx(params: {\n    authority: web3.PublicKey;\n  }): Promise<web3.TransactionInstruction> {\n    const ix = await this.program.instruction.oracleSetConfigs(\n      {\n        authority: params.authority,\n        newSecpAuthority: null,\n      },\n      {\n        accounts: {\n          oracle: this.pubkey,\n          authority: params.authority,\n        },\n      }\n    );\n    return ix;\n  }\n\n  /**\n   *  Loads the oracle data for this {@linkcode Oracle} account from on chain.\n   *\n   *  @returns A promise that resolves to the oracle data.\n   *  @throws if the oracle account does not exist.\n   */\n  async loadData(): Promise<OracleAccountData> {\n    return await Oracle.loadData(this.program, this.pubkey);\n  }\n\n  async fetchGateway(): Promise<string> {\n    const data = await this.loadData();\n    const gw = Buffer.from(data.gatewayUri).toString();\n    return gw.replace(/\\0+$/, \"\");\n  }\n\n  /**\n   *  Loads the oracle data for this {@linkcode Oracle} account from on chain.\n   *\n   *  @returns A promise that resolves to the oracle data.\n   *  @throws if the oracle account does not exist.\n   */\n  static async loadData(\n    program: Program,\n    pubkey: web3.PublicKey\n  ): Promise<OracleAccountData> {\n    return await program.account[\"oracleAccountData\"].fetch(pubkey);\n  }\n\n  /**\n   * Loads the oracle data for a list of {@linkcode Oracle} accounts from on chain.\n   *\n   * @param program - The program that owns the oracle accounts.\n   * @param keys - The public keys of the oracle accounts to load.\n   * @returns A promise that resolves to an array of oracle data.\n   * @throws if any of the oracle accounts do not exist.\n   */\n  static async loadMany(\n    program: Program,\n    keys: web3.PublicKey[]\n  ): Promise<(OracleAccountData | null)[]> {\n    return await program.account[\"oracleAccountData\"].fetchMultiple(keys);\n  }\n\n  /**\n   * Loads the oracle data and checks if the oracle is verified.\n   *\n   * @returns A promise that resolves to a tuple containing a boolean indicating\n   * if the oracle is verified and the expiration time of the verification.\n   * @throws if the oracle account does not exist.\n   */\n  async verificationStatus(): Promise<[boolean, number]> {\n    const data = await this.loadData();\n    const now = new BN(Date.now() / 1000);\n    const status = data.enclave.verificationStatus;\n    const expiration = data.enclave.validUntil;\n    return [status === 4 && now.lt(expiration), expiration.toNumber()];\n  }\n\n  /**\n   * Get the pubkey of the stats account for this oracle.\n   * @returns A promise that resolves to the pubkey of the stats account.\n   */\n  async statsKey(): Promise<web3.PublicKey> {\n    return (\n      await web3.PublicKey.findProgramAddress(\n        [Buffer.from(\"OracleStats\"), this.pubkey.toBuffer()],\n        this.program.programId\n      )\n    )[0];\n  }\n\n  async lutKey(): Promise<web3.PublicKey> {\n    const data = await this.loadData();\n    const lutSigner = (\n      await web3.PublicKey.findProgramAddress(\n        [Buffer.from(\"LutSigner\"), this.pubkey.toBuffer()],\n        this.program.programId\n      )\n    )[0];\n    const [_, lutKey] = await web3.AddressLookupTableProgram.createLookupTable({\n      authority: lutSigner,\n      payer: web3.PublicKey.default,\n      recentSlot: BigInt(data.lutSlot.toString()),\n    });\n    return lutKey;\n  }\n\n  public lookupTableKey(data: { lutSlot: number | bigint }): web3.PublicKey {\n    const lutSigner = web3.PublicKey.findProgramAddressSync(\n      [Buffer.from(\"LutSigner\"), this.pubkey.toBuffer()],\n      this.program.programId\n    )[0];\n    const [_, lutKey] = web3.AddressLookupTableProgram.createLookupTable({\n      authority: lutSigner,\n      payer: web3.PublicKey.default,\n      recentSlot: data.lutSlot,\n    });\n    return lutKey;\n  }\n\n  async loadLookupTable(): Promise<web3.AddressLookupTableAccount> {\n    if (this.lut !== null && this.lut !== undefined) {\n      return this.lut;\n    }\n    const lutKey = await this.lutKey();\n    const accnt = await this.program.provider.connection.getAddressLookupTable(\n      lutKey\n    );\n    this.lut = accnt.value!;\n    return this.lut!;\n  }\n}\n"]}